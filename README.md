<p align="center">
  <img height="107" src="https://raw.githubusercontent.com/konkonam/nuxt-shopify/refs/heads/main/docs/public/logo-readme.png">
</p>

# Nuxt Shopify

[![Github Actions][github-actions-src]][github-actions-href]
[![NPM version][npm-version-src]][npm-version-href]
[![NPM downloads][npm-downloads-src]][npm-downloads-href]
[![NPM last update][npm-last-update-src]][npm-last-update-href]
[![License][license-src]][license-href]

Easy Shopify GraphQL API-Connector for Nuxt 3 & 4.

- üõçÔ∏è [Store Template](https://github.com/konkonam/nuxt-shopify/tree/main/template)
- üèÄ [Online Demo (WIP)](https://nuxt-shopify.vercel.app)
- üìö [Documentation](https://konkonam.github.io/nuxt-shopify)
- ‚ú® [Release Notes](https://github.com/konkonam/nuxt-shopify/tree/main/CHANGELOG.md)

## ‚ö°Ô∏è Features

Automatically generates and hot-reloads TypeScript types from your GraphQL operations

- üîå Plug & play Shopify integration
- üîó Fully typed fetch client from GraphQL queries
- üî• Hot-reloads types automatically when queries change
- üõí Storefront and Admin API support
- ‚öôÔ∏è Customizable GraphQL code generation
- üß© GraphQL fragments support
- üì¶ Auto-imports for GraphQL queries, fragments and generated types
- üß™ Tested with Nuxt 3 & 4
- üåê Server & client side support
- üîê Secure access token handling
- üèñÔ∏è Sandbox integrated with GraphiQL Explorer

## üì¶ Setup

Run the following command to install the module in your project:

```bash
npm install @konkonam/nuxt-shopify
```

Add the module to your `nuxt.config.ts`:

```ts
export default defineNuxtConfig({
    modules: [
        '@konkonam/nuxt-shopify',
    ],
})
```

Add your Shopify configuration to the `nuxt.config.ts`:

```ts
export default defineNuxtConfig({
    shopify: {
        name: 'quickstart-abcd1234',
        clients: {
            storefront: {
                apiVersion: '2025-04',
                publicAccessToken: 'YOUR_ACCESS_TOKEN',
            },

            admin: {
                apiVersion: '2025-04',
                accessToken: 'YOUR_ACCESS_TOKEN',
            },
        },
    },
})
```

## üõ†Ô∏è Usage

### Access Storefront API on the client side

There are multiple ways of communicating with the Shopify APIs.
The easiest way is with the `useStorefront` composable, directly inside of your vue component or page.

> To access the `useStorefront` composable on the client side, make sure you have added a public access token.
> You can add it in the module config: `clients > storefront > publicAccessToken`

```html
<!-- ~/pages/your-page.vue -->

<script setup lang="ts">
const storefront = useStorefront()

const { data } = await storefront.request(`#graphql
    query FetchProducts($first: Int) {
        products(first: $first) {
            nodes {
                id
                title
                description
            }
        }
    }
`, {
    variables: {
        first: 3,
    },
})
</script>

<template>
    <pre>{{ data?.products }}</pre>
</template>
```

This will fetch the first three products from your Shopify store and display them in a `<pre>` tag.

The `data` variable will be typed as `FetchProductsQuery`, which is auto-generated by the module to enable autocompletion and full type checking.

You can use this generated `FetchProductsQuery` type anywhere in your code to ensure type safety when working with the query response within components.

### Access APIs via Nitro endpoints

The module exposes utilities to access each API via Nitro endpoints.

#### Storefront API example

You can use the `useStorefront` utility to access the storefront API:

```ts
// ~/server/api/products.ts

export default defineEventHandler(async () => {
    const storefront = useStorefront()

    return await storefront.request(`#graphql
        query FetchProducts($first: Int) {
            products(first: $first) {
                nodes {
                    id
                    title
                    description
                }
            }
        }
    `, {
        variables: {
            first: 3,
        },
    })
})
```

Notice how we can use the `graphql` directive inside the event handler, this is possible because in
the standard module configuration all `.ts` and `.gql` files are automatically processed for the
storefront API, as long as the don't end with `.admin.ts` or `.admin.gql`.
Read more about the [codegen configuration](https://konkonam.github.io/nuxt-shopify/configuration/codegen).

Now we can call the API at `/api/products` to obtain the first three products:

```html
<!-- ~/pages/your-page.vue -->

<script setup lang="ts">
const { data } = await useFetch('/api/products')
</script>

<template>
    <pre>{{ data }}</pre>
</template>
```

The `data` variable will be typed as `Ref<ClientResponse<FetchProductsQuery>>`, which enables autocompletion and full
type checking.

#### Admin API example

Files ending with `.admin.ts` or `.admin.gql` will automatically be processed for the admin API.
We can use the `useAdmin` utility to access the admin API in a nitro event handler:

```ts
// ~/server/api/your-admin-api-handler.ts

export default defineEventHandler(async () => {
    const admin = useAdmin()

    return await admin.request(...)
})
```

For a full example, see [Admin API examples](https://konkonam.github.io/nuxt-shopify/examples/admin).

### Type generation

Once installed, the module automatically generates your GraphQL types and saves them in:
- .nuxt/types ‚Äî Type definitions
- .nuxt/schema ‚Äî GraphQL schema files

To enable IDE support, you can add a GraphQL configuration file:

```yaml
# ~/graphql.config.yml

schema:
  - ./.nuxt/schema/storefront.schema.json
  - ./.nuxt/schema/admin.schema.json
```

### Handling GraphQL fragments

You can define reusable fragments in your GraphQL queries to avoid duplication and make your queries more maintainable. The module supports fragment usage out of the box.

Here's an example of how to define and use a fragment:

```graphql
#graphql
fragment ProductFields on Product {
    id
    title
    description
}

query FetchProducts($first: Int) {
    products(first: $first) {
        nodes {
            ...ProductFields
        }
    }
}
```

You can place this query in a `.gql`, `.ts` or `.vue` file and use it in your requests. The module will be able to import the fragment and allow you to use it directly within your GraphQL operation.

Files placed in the `~/graphql` directory will be automatically imported by the module, so it is recommended to organize your fragments there.

## ü§ù Contributing

1. Clone this repository
2. Create a `.env` file (see [`.env.example`](https://github.com/konkonam/nuxt-shopify/tree/main/.env.example))
3. Install dependencies using:
    ```bash
    bun install
    ```
4. Run `bun run prepare:dev` to generate type stubs.
5. Start the default [playground](https://github.com/konkonam/nuxt-shopify/tree/main/playgrounds/playground) with:
    ```bash
    bun run dev
    ```

## üìú License

Published under the [MIT License](https://github.com/konkonam/nuxt-shopify/tree/main/LICENSE).

[github-actions-src]: https://github.com/konkonam/nuxt-shopify/actions/workflows/test.yml/badge.svg
[github-actions-href]: https://github.com/konkonam/nuxt-shopify/actions

[npm-version-src]: https://img.shields.io/npm/v/@konkonam/nuxt-shopify/latest.svg?style=flat&colorA=18181B&colorB=31C553
[npm-version-href]: https://npmjs.com/package/@konkonam/nuxt-shopify

[npm-downloads-src]: https://img.shields.io/npm/dm/@konkonam/nuxt-shopify.svg?style=flat&colorA=18181B&colorB=31C553
[npm-downloads-href]: https://npmjs.com/package/@konkonam/nuxt-shopify

[npm-last-update-src]: https://img.shields.io/npm/last-update/%40konkonam%2Fnuxt-shopify.svg?style=flat&colorA=18181B&colorB=31C553
[npm-last-update-href]: https://npmjs.com/package/@konkonam/nuxt-shopify

[license-src]: https://img.shields.io/github/license/konkonam/nuxt-shopify.svg?style=flat&colorA=18181B&colorB=31C553
[license-href]: https://github.com/konkonam/nuxt-shopify/tree/main/LICENSE
